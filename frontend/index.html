<!DOCTYPE html>
<html>
<head>
  <title>Bikes Frontend</title>
</head>
<body>
  <h1>Bikes Frontend</h1>
  <div id="bikesList"></div>

  <form id="bikeForm">
    <input type="text" id="nameInput" placeholder="Bike name" required>
    <button type="submit">Create Bike</button>
  </form>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const bikesList = document.getElementById('bikesList');
      const bikeForm = document.getElementById('bikeForm');
      const nameInput = document.getElementById('nameInput');

      // Fetch and display all bikes
      const fetchBikes = () => {
        fetch('/bikes')
          .then(response => response.json())
          .then(data => {
            bikesList.innerHTML = '';
            data.forEach(bike => {
              const bikeItem = document.createElement('div');
              bikeItem.innerHTML = `
                <p>ID: ${bike.id}</p>
                <p>Name: ${bike.name}</p>
                <button onclick="updateBike(${bike.id})">Update</button>
                <button onclick="deleteBike(${bike.id})">Delete</button>
              `;
              bikesList.appendChild(bikeItem);
            });
          })
          .catch(error => {
            console.error('Error:', error);
            bikesList.textContent = 'Error retrieving bikes.';
          });
      };

      // Create a new bike
      bikeForm.addEventListener('submit', event => {
        event.preventDefault();
        const bikeName = nameInput.value;

        fetch('/bikes', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ name: bikeName })
        })
          .then(response => {
            if (response.ok) {
              nameInput.value = '';
              fetchBikes();
            } else {
              throw new Error('Failed to create bike.');
            }
          })
          .catch(error => {
            console.error('Error:', error);
            bikesList.textContent = 'Error creating bike.';
          });
      });

      // Update a bike
      window.updateBike = bikeId => {
        const newBikeName = prompt('Enter the new name for the bike:');
        if (newBikeName) {
          fetch(`/bikes/${bikeId}`, {
            method: 'PUT',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ name: newBikeName })
          })
            .then(response => {
              if (response.ok) {
                fetchBikes();
              } else {
                throw new Error('Failed to update bike.');
              }
            })
            .catch(error => {
              console.error('Error:', error);
              bikesList.textContent = 'Error updating bike.';
            });
        }
      };

      // Delete a bike
      window.deleteBike = bikeId => {
        if (confirm('Are you sure you want to delete this bike?')) {
          fetch(`/bikes/${bikeId}`, {
            method: 'DELETE'
          })
            .then(response => {
              if (response.ok) {
                fetchBikes();
              } else {
                throw new Error('Failed to delete bike.');
              }
            })
            .catch(error => {
              console.error('Error:', error);
              bikesList.textContent = 'Error deleting bike.';
            });
        }
      };

      // Fetch and display bikes when the page loads
      fetchBikes();
    });
  </script>
</body>
</html>
